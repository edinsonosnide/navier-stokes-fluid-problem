# ğŸŒ€ Navierâ€“Stokes Fluid Simulation (Python)

This repository contains a numerical simulation of an incompressible 2D fluid flowing through a domain with obstacles, using the Navierâ€“Stokes equations discretized with finite differences.  
The project includes:

- A **nonlinear solver** (Newtonâ€“Raphson)
- Multiple **iterative linear solvers** (Jacobi, Gaussâ€“Seidel, Richardson, SOR, Gradient Descent, Conjugate Gradient)
- A module for **bidimensional cubic spline interpolation** to refine the solution from a coarse grid to a high-resolution grid

---

## ğŸ“ Project Structure

```text
sistema_no_lineal/
 â””â”€â”€ newton_raphson.py          # Nonlinear solver for Navierâ€“Stokes

sistemas_lineales/
 â”œâ”€â”€ conjugate_gradient.py
 â”œâ”€â”€ gauss_sidel.py
 â”œâ”€â”€ gradient_descent.py
 â”œâ”€â”€ jacobi.py
 â”œâ”€â”€ richardson.py
 â”œâ”€â”€ sor.py
 â””â”€â”€ utils.py                   # Matrix and helper functions

splines/
 â”œâ”€â”€ cubic_spline.py            # Main 2D spline interpolation
 â”œâ”€â”€ cubic_spline_backup.py
 â””â”€â”€ transposing_matrix.py

images_results/
 â”œâ”€â”€ 8x80.png
 â”œâ”€â”€ 40X400.png
 â”œâ”€â”€ color_range.png
 â”œâ”€â”€ newton-raphson.png
 â”œâ”€â”€ sor.png
 â””â”€â”€ splines.png

random_tests_sistemas_lineales.py
transposing_matrix.py
workshop1/
```

---

## ğŸ”§ Installing Dependencies

### ğŸŸ£ Using Anaconda (Recommended)

You can run this entire project using **Anaconda** with an isolated environment.

1ï¸âƒ£ Create a Conda environment with Python **3.12.7**:

```bash
conda create -n navier python=3.12.7
```

2ï¸âƒ£ Activate the environment:

```bash
conda activate navier
```

3ï¸âƒ£ Install dependencies from `requirements.txt`:

```bash
pip install -r requirements.txt
```

---

### ğŸŸ¦ Alternative: Using a Virtual Environment (venv)

```bash
python -m venv .venv
source .venv/bin/activate       # Linux / Mac
.venv\Scripts\activate        # Windows
pip install -r requirements.txt
```

---

## ğŸš€ Running the Code

> **Important:** All examples assume you run the commands from the **root folder** of the repository.

### â–¶ï¸ Nonlinear Solver (Newtonâ€“Raphson)

```bash
python -m sistema_no_lineal.newton_raphson
```

This script:

- Builds the computational grid  
- Assembles the nonlinear Navierâ€“Stokes system  
- Solves it using Newtonâ€“Raphson  
- Uses one of the iterative linear solvers internally  
- Produces the coarse-grid velocity field  

---

### â–¶ï¸ Run Linear Solvers Individually

```bash
python -m sistemas_lineales.jacobi
python -m sistemas_lineales.gauss_sidel
python -m sistemas_lineales.sor
python -m sistemas_lineales.richardson
python -m sistemas_lineales.gradient_descent
python -m sistemas_lineales.conjugate_gradient
```

Each module runs a test problem and reports convergence information (iterations, residual, time).

---

### â–¶ï¸ Run the 2D Spline Interpolation

Refine the 8Ã—80 solution to the 40Ã—400 grid:

```bash
python -m splines.cubic_spline
```

This script:

- Rebuilds the velocity field on the coarse (8Ã—80) grid  
- Applies cubic spline interpolation in \(x\) and \(y\)  
- Produces a smooth field on the fine 40Ã—400 grid  

---

### â–¶ï¸ Random Linear-System Tests

```bash
python -m random_tests_sistemas_lineales
```

Used to compare convergence and performance of the different linear solvers.

---

## ğŸ“Š Results Preview

The `images_results/` folder contains example outputs generated by the scripts.

### ğŸ§± Geometry and Grids

**Coarse 8Ã—80 grid with inlet and obstacles:**

![Coarse grid 8x80](images_results/8x80.png)

**Fine 40Ã—400 grid used for visualization after refinement:**

![Fine grid 40x400](images_results/40X400.png)

---

### ğŸ¨ Colormap

The simulations use a continuous colormap for the velocity magnitude:

![Velocity colormap](images_results/color_range.png)

---

### ğŸ§® Newtonâ€“Raphson Solution (Nonlinear System)

Example of the converged velocity field on the 8Ã—80 grid, obtained with the **Newtonâ€“Raphson** nonlinear solver:

![Newtonâ€“Raphson solution](images_results/newton-raphson.png)

---

### âš™ï¸ SOR Linear Solver

Example of the velocity field when solving the linear system with the **SOR (Successive Over-Relaxation)** method:

![SOR solution](images_results/sor.png)

---

### ğŸ“ˆ Spline-Based Refinement (40Ã—400)

The coarse solution is prolonged to the fine 40Ã—400 grid using 2D cubic splines, producing a smooth field that respects the boundaries and obstacles:

![Refined solution with splines](images_results/splines.png)

---

## ğŸ“Œ Notes

- The design is modular: nonlinear and linear solvers, as well as interpolation, are separated into different packages.
- The spline module can be reused as a general 2D grid refinement tool.
- Only standard scientific Python packages are required (NumPy, Matplotlib, etc.).

---

## ğŸ“„ License

This project is for academic and research purposes.  
You may modify or extend it freely.
